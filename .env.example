# ===========================================
# HPE GreenLake Sync - Environment Configuration
# ===========================================
# Copy this file to .env and configure your values.
# NEVER commit .env to version control!

# ===========================================
# PostgreSQL Database (Required)
# ===========================================
POSTGRES_USER=glp
POSTGRES_PASSWORD=<your-secure-password>
POSTGRES_DB=greenlake

# For local development without Docker:
# DATABASE_URL=postgresql://glp:password@localhost:5432/greenlake

# ===========================================
# Redis (Required for WebSocket auth)
# ===========================================
REDIS_PASSWORD=<your-redis-password>
# Note: REDIS_URL is constructed automatically in Docker Compose

# ===========================================
# GreenLake Platform API (Required)
# ===========================================
GLP_CLIENT_ID=<your-client-id>
GLP_CLIENT_SECRET=<your-client-secret>
GLP_TOKEN_URL=https://sso.common.cloud.hpe.com/as/token.oauth2
GLP_BASE_URL=https://global.api.greenlake.hpe.com

# ===========================================
# Aruba Central API (Optional)
# ===========================================
# Only needed if syncing from Aruba Central
ARUBA_CLIENT_ID=<your-aruba-client-id>
ARUBA_CLIENT_SECRET=<your-aruba-client-secret>
ARUBA_TOKEN_URL=https://sso.common.cloud.hpe.com/as/token.oauth2
ARUBA_BASE_URL=https://us2.api.central.arubanetworks.com

# ===========================================
# API Security (Required for Production)
# ===========================================
# For DEVELOPMENT: Set DISABLE_AUTH=true to bypass auth
DISABLE_AUTH=false

# For PRODUCTION: Generate secure API key
# Run: python -c "import secrets; print(secrets.token_urlsafe(32))"
API_KEY=<your-secure-api-key>

# ===========================================
# JWT Authentication (Required for Agent Chatbot)
# ===========================================
# For DEVELOPMENT: Set REQUIRE_AUTH=false
REQUIRE_AUTH=true

# For PRODUCTION: Generate secure JWT secret (64+ chars)
# Run: python -c "import secrets; print(secrets.token_urlsafe(48))"
JWT_SECRET=<your-jwt-secret-64-chars-minimum>
JWT_ALGORITHM=HS256

# Optional: Validate issuer/audience claims
# JWT_ISSUER=https://your-idp.com
# JWT_AUDIENCE=glp-api
JWT_CLOCK_SKEW_SECONDS=30

# Custom claim names (if your IdP uses different names)
JWT_TENANT_ID_CLAIM=tenant_id
JWT_USER_ID_CLAIM=sub
JWT_SESSION_ID_CLAIM=session_id

# ===========================================
# WebSocket Security (Agent Chatbot)
# ===========================================
# Maximum WebSocket message size in MB (default: 1)
# Protects against memory exhaustion attacks from oversized payloads.
#
# This limit is enforced at TWO levels:
# 1. Server level (Uvicorn --ws-max-size): Rejects messages BEFORE buffering (prevents memory exhaustion)
# 2. Application level: Provides graceful error messages to clients
#
# The server-level limit is configured automatically based on this value.
# Increase only if legitimate use cases require larger messages (e.g., file transfers).
# Note: Changing this requires server restart to take effect.
#
# WS_MAX_MESSAGE_SIZE_MB=1

# ===========================================
# AI Model Configuration (Optional)
# ===========================================
# At least one LLM provider is needed for the chatbot

# Anthropic (Claude) - Recommended
ANTHROPIC_API_KEY=<your-anthropic-api-key>
ANTHROPIC_MODEL=claude-sonnet-4-5-20250929

# OpenAI (GPT)
OPENAI_API_KEY=<your-openai-api-key>
OPENAI_MODEL=gpt-4o
OPENAI_EMBEDDING_MODEL=text-embedding-3-large

# Ollama (Local - no API key needed)
OLLAMA_MODEL=qwen3:4b
OLLAMA_BASE_URL=http://localhost:11434

# ===========================================
# Extended Thinking Configuration (Optional)
# ===========================================
# Enable extended thinking for complex queries (Anthropic only)
ENABLE_THINKING=false

# Token budget for thinking (default: 10000)
# Higher values allow more thorough reasoning but cost more
THINKING_BUDGET=10000

# ===========================================
# Scheduler Settings
# ===========================================
SYNC_INTERVAL_MINUTES=60
SYNC_DEVICES=true
SYNC_SUBSCRIPTIONS=true
SYNC_ON_STARTUP=true
SYNC_MAX_RETRIES=3
SYNC_RETRY_DELAY_MINUTES=5
HEALTH_CHECK_PORT=8080

# ===========================================
# CORS Configuration (Production)
# ===========================================
# Comma-separated list of allowed origins
# Development: http://localhost:3000,http://localhost:5173
# Production: https://your-domain.com
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# ===========================================
# Docker Hub Configuration (Production)
# ===========================================
# Your Docker Hub username (default: jgiet001)
DOCKERHUB_USERNAME=jgiet001
# Image tag (default: latest)
IMAGE_TAG=latest

# ===========================================
# Port Configuration
# ===========================================
# Frontend port (default: 80)
FRONTEND_PORT=80
# API server port - development only (default: 8000)
API_PORT=8000
# MCP server port (default: 8010)
MCP_PORT=8010

# ===========================================
# MCP Server Settings
# ===========================================
MCP_DB_POOL_MIN=2
MCP_DB_POOL_MAX=10

# ===========================================
# Device Operation Limits
# ===========================================
MAX_DEVICES_PER_OPERATION=25
